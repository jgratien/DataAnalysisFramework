{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 75,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Starting new HTTP connection (1): localhost:9086\n",
      "http://localhost:9086 \"POST /query?q=CREATE+RETENTION+POLICY+%22test_policy%22+ON+%22test%22+DURATION+INF+REPLICATION+1+SHARD+DURATION+1h50m&db=test HTTP/1.1\" 200 None\n",
      "Initializing Jaeger Tracer with UDP reporter\n",
      "Using selector: EpollSelector\n",
      "Using sampler ConstSampler(True)\n",
      "Added sensor with name connections-closed\n",
      "Added sensor with name connections-created\n",
      "Added sensor with name select-time\n",
      "Added sensor with name io-time\n",
      "Initiating connection to node bootstrap-0 at localhost:9092\n",
      "Added sensor with name bytes-sent-received\n",
      "Added sensor with name bytes-sent\n",
      "Added sensor with name bytes-received\n",
      "Added sensor with name request-latency\n",
      "Added sensor with name node-bootstrap-0.bytes-sent\n",
      "Added sensor with name node-bootstrap-0.bytes-received\n",
      "Added sensor with name node-bootstrap-0.latency\n",
      "<BrokerConnection node_id=bootstrap-0 host=localhost:9092 <disconnected> [unspecified None]>: creating new socket\n",
      "<BrokerConnection node_id=bootstrap-0 host=localhost:9092 <disconnected> [IPv6 ('::1', 9092, 0, 0)]>: setting socket option (6, 1, 1)\n",
      "<BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: connecting to localhost:9092 [('::1', 9092, 0, 0) IPv6]\n",
      "Probing node bootstrap-0 broker version\n",
      "<BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: established TCP connection\n",
      "<BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connecting> [IPv6 ('::1', 9092, 0, 0)]>: Connection complete.\n",
      "Node bootstrap-0 connected\n",
      "Sending request ApiVersionRequest_v0()\n",
      "<BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]> Request 1: ApiVersionRequest_v0()\n",
      "Sending request MetadataRequest_v0(topics=[])\n",
      "<BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]> Request 2: MetadataRequest_v0(topics=[])\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Trying to connect to InfluxDB server without proxy: localhost on port: 9086\n",
      "connection sucess!\n",
      "error : create now tracer...\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Received correlation id: 1\n",
      "Processing response ApiVersionResponse_v0\n",
      "<BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]> Response 1 (106.46820068359375 ms): ApiVersionResponse_v0(error_code=0, api_versions=[(api_key=0, min_version=0, max_version=8), (api_key=1, min_version=0, max_version=11), (api_key=2, min_version=0, max_version=5), (api_key=3, min_version=0, max_version=9), (api_key=4, min_version=0, max_version=4), (api_key=5, min_version=0, max_version=2), (api_key=6, min_version=0, max_version=6), (api_key=7, min_version=0, max_version=3), (api_key=8, min_version=0, max_version=8), (api_key=9, min_version=0, max_version=6), (api_key=10, min_version=0, max_version=3), (api_key=11, min_version=0, max_version=6), (api_key=12, min_version=0, max_version=4), (api_key=13, min_version=0, max_version=4), (api_key=14, min_version=0, max_version=4), (api_key=15, min_version=0, max_version=5), (api_key=16, min_version=0, max_version=3), (api_key=17, min_version=0, max_version=1), (api_key=18, min_version=0, max_version=3), (api_key=19, min_version=0, max_version=5), (api_key=20, min_version=0, max_version=4), (api_key=21, min_version=0, max_version=1), (api_key=22, min_version=0, max_version=2), (api_key=23, min_version=0, max_version=3), (api_key=24, min_version=0, max_version=1), (api_key=25, min_version=0, max_version=1), (api_key=26, min_version=0, max_version=1), (api_key=27, min_version=0, max_version=0), (api_key=28, min_version=0, max_version=2), (api_key=29, min_version=0, max_version=1), (api_key=30, min_version=0, max_version=1), (api_key=31, min_version=0, max_version=1), (api_key=32, min_version=0, max_version=2), (api_key=33, min_version=0, max_version=1), (api_key=34, min_version=0, max_version=1), (api_key=35, min_version=0, max_version=1), (api_key=36, min_version=0, max_version=1), (api_key=37, min_version=0, max_version=1), (api_key=38, min_version=0, max_version=2), (api_key=39, min_version=0, max_version=1), (api_key=40, min_version=0, max_version=1), (api_key=41, min_version=0, max_version=1), (api_key=42, min_version=0, max_version=2), (api_key=43, min_version=0, max_version=2), (api_key=44, min_version=0, max_version=1), (api_key=45, min_version=0, max_version=0), (api_key=46, min_version=0, max_version=0), (api_key=47, min_version=0, max_version=0)])\n",
      "Received correlation id: 2\n",
      "Processing response MetadataResponse_v0\n",
      "<BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]> Response 2 (8.30698013305664 ms): MetadataResponse_v0(brokers=[(node_id=0, host='irlin328206', port=9092)], topics=[(error_code=0, topic='CRY.CENTRALE_SOLAIRE.CRY_act_prod_pow', partitions=[(error_code=0, partition=0, leader=0, replicas=[0], isr=[0])]), (error_code=0, topic='eolienne_jour_1', partitions=[(error_code=0, partition=0, leader=0, replicas=[0], isr=[0])]), (error_code=0, topic='CRY.TGBT_NORMAL.CRY_act_cons_po', partitions=[(error_code=0, partition=0, leader=0, replicas=[0], isr=[0])]), (error_code=0, topic='__consumer_offsets', partitions=[(error_code=0, partition=0, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=10, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=20, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=40, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=30, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=9, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=39, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=11, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=31, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=13, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=18, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=22, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=8, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=32, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=43, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=29, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=34, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=1, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=6, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=41, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=27, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=48, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=5, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=15, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=35, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=25, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=46, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=26, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=36, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=44, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=16, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=37, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=17, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=45, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=3, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=4, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=24, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=38, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=33, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=23, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=28, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=2, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=12, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=19, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=14, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=47, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=49, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=42, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=7, leader=0, replicas=[0], isr=[0]), (error_code=0, partition=21, leader=0, replicas=[0], isr=[0])]), (error_code=0, topic='CRY.TGBT_NORMAL.CRY_app_cons_pow', partitions=[(error_code=0, partition=0, leader=0, replicas=[0], isr=[0])]), (error_code=0, topic='topic_all_tags', partitions=[(error_code=0, partition=0, leader=0, replicas=[0], isr=[0])]), (error_code=0, topic='eolienne_jour_7', partitions=[(error_code=0, partition=0, leader=0, replicas=[0], isr=[0])]), (error_code=0, topic='CRY.TGBT_NORMAL.CRY_rea_cons_pow', partitions=[(error_code=0, partition=0, leader=0, replicas=[0], isr=[0])]), (error_code=0, topic='CRY.TGBT_NORMAL.CRY_act_cons_pow', partitions=[(error_code=0, partition=0, leader=0, replicas=[0], isr=[0])]), (error_code=0, topic='CRY.CENTRALE_SOLAIRE.CRY_app_prod_pow', partitions=[(error_code=0, partition=0, leader=0, replicas=[0], isr=[0])]), (error_code=0, topic='CRY.TGBT_NORMAL.CRY_app_prod_pow', partitions=[(error_code=0, partition=0, leader=0, replicas=[0], isr=[0])]), (error_code=0, topic='mytopic', partitions=[(error_code=0, partition=0, leader=0, replicas=[0], isr=[0])]), (error_code=0, topic='CRY.CENTRALE_SOLAIRE.CRY_app_cons_pow', partitions=[(error_code=0, partition=0, leader=0, replicas=[0], isr=[0])])])\n",
      "Broker version identified as 1.0.0\n",
      "Set configuration api_version=(1, 0, 0) to skip auto check_version requests on startup\n",
      "Added sensor with name bytes-fetched\n",
      "Added sensor with name records-fetched\n",
      "Added sensor with name fetch-latency\n",
      "Added sensor with name records-lag\n",
      "Added sensor with name fetch-throttle-time\n",
      "Added sensor with name heartbeat-latency\n",
      "Added sensor with name join-latency\n",
      "Added sensor with name sync-latency\n",
      "group_id is None: disabling auto-commit.\n",
      "Added sensor with name commit-latency\n",
      "Seeking to end of partition TopicPartition(topic='eolienne_jour_1', partition=0)\n",
      "Resetting offset for partition TopicPartition(topic='eolienne_jour_1', partition=0) to latest offset.\n",
      "Partition TopicPartition(topic='eolienne_jour_1', partition=0) is unknown for fetching offset, wait for metadata refresh\n",
      "Sending metadata request MetadataRequest_v1(topics=['eolienne_jour_1']) to node bootstrap-0\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Sending request MetadataRequest_v1(topics=['eolienne_jour_1'])\n",
      "<BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]> Request 3: MetadataRequest_v1(topics=['eolienne_jour_1'])\n",
      "Received correlation id: 3\n",
      "Processing response MetadataResponse_v1\n",
      "<BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]> Response 3 (3.368377685546875 ms): MetadataResponse_v1(brokers=[(node_id=0, host='irlin328206', port=9092, rack=None)], controller_id=0, topics=[(error_code=0, topic='eolienne_jour_1', is_internal=False, partitions=[(error_code=0, partition=0, leader=0, replicas=[0], isr=[0])])])\n",
      "Updated cluster metadata to ClusterMetadata(brokers: 1, topics: 1, groups: 0)\n",
      "Stale metadata was raised, and we now have an updated metadata. Rechecking partition existance\n",
      "Initiating connection to node 0 at irlin328206:9092\n",
      "Added sensor with name node-0.bytes-sent\n",
      "Added sensor with name node-0.bytes-received\n",
      "Added sensor with name node-0.latency\n",
      "<BrokerConnection node_id=0 host=irlin328206:9092 <disconnected> [unspecified None]>: creating new socket\n",
      "<BrokerConnection node_id=0 host=irlin328206:9092 <disconnected> [IPv6 ('fe80::9a90:96ff:fead:e31d', 9092, 0, 2)]>: setting socket option (6, 1, 1)\n",
      "<BrokerConnection node_id=0 host=irlin328206:9092 <connecting> [IPv6 ('fe80::9a90:96ff:fead:e31d', 9092, 0, 2)]>: connecting to irlin328206:9092 [('fe80::9a90:96ff:fead:e31d', 9092, 0, 2) IPv6]\n",
      "<BrokerConnection node_id=0 host=irlin328206:9092 <connecting> [IPv6 ('fe80::9a90:96ff:fead:e31d', 9092, 0, 2)]>: established TCP connection\n",
      "<BrokerConnection node_id=0 host=irlin328206:9092 <connecting> [IPv6 ('fe80::9a90:96ff:fead:e31d', 9092, 0, 2)]>: Connection complete.\n",
      "Node 0 connected\n",
      "<BrokerConnection node_id=bootstrap-0 host=localhost:9092 <connected> [IPv6 ('::1', 9092, 0, 0)]>: Closing connection. \n",
      "Sending request OffsetRequest_v1(replica_id=-1, topics=[(topic='eolienne_jour_1', partitions=[(partition=0, timestamp=-1)])])\n",
      "<BrokerConnection node_id=0 host=irlin328206:9092 <connected> [IPv6 ('fe80::9a90:96ff:fead:e31d', 9092, 0, 2)]> Request 1: OffsetRequest_v1(replica_id=-1, topics=[(topic='eolienne_jour_1', partitions=[(partition=0, timestamp=-1)])])\n",
      "Received correlation id: 1\n",
      "Processing response OffsetResponse_v1\n",
      "<BrokerConnection node_id=0 host=irlin328206:9092 <connected> [IPv6 ('fe80::9a90:96ff:fead:e31d', 9092, 0, 2)]> Response 1 (4.168272018432617 ms): OffsetResponse_v1(topics=[(topic='eolienne_jour_1', partitions=[(partition=0, error_code=0, timestamp=-1, offset=7270)])])\n",
      "Handling ListOffsetResponse response for TopicPartition(topic='eolienne_jour_1', partition=0). Fetched offset 7270, timestamp -1\n",
      "Seeking to beginning of partition TopicPartition(topic='eolienne_jour_1', partition=0)\n",
      "Resetting offset for partition TopicPartition(topic='eolienne_jour_1', partition=0) to earliest offset.\n",
      "Sending request OffsetRequest_v1(replica_id=-1, topics=[(topic='eolienne_jour_1', partitions=[(partition=0, timestamp=-2)])])\n",
      "<BrokerConnection node_id=0 host=irlin328206:9092 <connected> [IPv6 ('fe80::9a90:96ff:fead:e31d', 9092, 0, 2)]> Request 2: OffsetRequest_v1(replica_id=-1, topics=[(topic='eolienne_jour_1', partitions=[(partition=0, timestamp=-2)])])\n",
      "Received correlation id: 2\n",
      "Processing response OffsetResponse_v1\n",
      "<BrokerConnection node_id=0 host=irlin328206:9092 <connected> [IPv6 ('fe80::9a90:96ff:fead:e31d', 9092, 0, 2)]> Response 2 (4.124879837036133 ms): OffsetResponse_v1(topics=[(topic='eolienne_jour_1', partitions=[(partition=0, error_code=0, timestamp=-1, offset=0)])])\n",
      "Handling ListOffsetResponse response for TopicPartition(topic='eolienne_jour_1', partition=0). Fetched offset 0, timestamp -1\n",
      "Adding fetch request for partition TopicPartition(topic='eolienne_jour_1', partition=0) at offset 0\n",
      "Sending FetchRequest to node 0\n",
      "Sending request FetchRequest_v4(replica_id=-1, max_wait_time=500, min_bytes=1, max_bytes=52428800, isolation_level=0, topics=[(topic='eolienne_jour_1', partitions=[(partition=0, offset=0, max_bytes=1048576)])])\n",
      "<BrokerConnection node_id=0 host=irlin328206:9092 <connected> [IPv6 ('fe80::9a90:96ff:fead:e31d', 9092, 0, 2)]> Request 3: FetchRequest_v4(replica_id=-1, max_wait_time=500, min_bytes=1, max_bytes=52428800, isolation_level=0, topics=[(topic='eolienne_jour_1', partitions=[(partition=0, offset=0, max_bytes=1048576)])])\n",
      "Received correlation id: 3\n",
      "Processing response FetchResponse_v4\n",
      "<BrokerConnection node_id=0 host=irlin328206:9092 <connected> [IPv6 ('fe80::9a90:96ff:fead:e31d', 9092, 0, 2)]> Response 3 (14.158487319946289 ms): FetchResponse_v4(throttle_time_ms=0, topics=[(topics='eolienne_jour_1', partitions=[(partition=0, error_code=0, highwater_offset=7270, last_stable_offset=7270, aborted_transactions=NULL, message_set=b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xad\\x00\\x00\\x00\\x00\\x02\\xf7\\x05hn\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01p\\x9f\\x87\\xb0\\xd5\\x00\\x00\\x01p\\x9f\\x87\\xb0\\xd5\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x01\\xf4\\x01\\x00\\x00\\x00\\x01\\xe6\\x010:02/10/2019 09:11;0;43.41266;-...')])])\n",
      "Adding fetched record for partition TopicPartition(topic='eolienne_jour_1', partition=0) with offset 0 to buffered record list\n",
      "Added sensor with name topic.eolienne_jour_1.bytes-fetched\n",
      "Added sensor with name topic.eolienne_jour_1.records-fetched\n",
      "Advance position for partition TopicPartition(topic='eolienne_jour_1', partition=0) from 4500 to 4606 (last message batch location plus one) to correct for deleted compacted messages\n",
      "Adding fetch request for partition TopicPartition(topic='eolienne_jour_1', partition=0) at offset 4606\n",
      "Sending FetchRequest to node 0\n",
      "Sending request FetchRequest_v4(replica_id=-1, max_wait_time=500, min_bytes=1, max_bytes=52428800, isolation_level=0, topics=[(topic='eolienne_jour_1', partitions=[(partition=0, offset=4606, max_bytes=1048576)])])\n",
      "<BrokerConnection node_id=0 host=irlin328206:9092 <connected> [IPv6 ('fe80::9a90:96ff:fead:e31d', 9092, 0, 2)]> Request 4: FetchRequest_v4(replica_id=-1, max_wait_time=500, min_bytes=1, max_bytes=52428800, isolation_level=0, topics=[(topic='eolienne_jour_1', partitions=[(partition=0, offset=4606, max_bytes=1048576)])])\n",
      "Received correlation id: 4\n",
      "Processing response FetchResponse_v4\n",
      "<BrokerConnection node_id=0 host=irlin328206:9092 <connected> [IPv6 ('fe80::9a90:96ff:fead:e31d', 9092, 0, 2)]> Response 4 (7.61866569519043 ms): FetchResponse_v4(throttle_time_ms=0, topics=[(topics='eolienne_jour_1', partitions=[(partition=0, error_code=0, highwater_offset=7270, last_stable_offset=7270, aborted_transactions=NULL, message_set=b'\\x00\\x00\\x00\\x00\\x00\\x00\\x11\\xfe\\x00\\x00\\x00\\xe0\\x00\\x00\\x00\\x00\\x02\\xf0S~C\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01p\\x9f\\xaa\\xedx\\x00\\x00\\x01p\\x9f\\xaa\\xedx\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x01\\xda\\x02\\x00\\x00\\x00\\x01\\xcc\\x024606:02/10/2019 10:27;4606;43.4...')])])\n",
      "Adding fetched record for partition TopicPartition(topic='eolienne_jour_1', partition=0) with offset 4606 to buffered record list\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "7270\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Advance position for partition TopicPartition(topic='eolienne_jour_1', partition=0) from 7106 to 7270 (last message batch location plus one) to correct for deleted compacted messages\n",
      "Adding fetch request for partition TopicPartition(topic='eolienne_jour_1', partition=0) at offset 7270\n",
      "Sending FetchRequest to node 0\n",
      "Sending request FetchRequest_v4(replica_id=-1, max_wait_time=500, min_bytes=1, max_bytes=52428800, isolation_level=0, topics=[(topic='eolienne_jour_1', partitions=[(partition=0, offset=7270, max_bytes=1048576)])])\n",
      "<BrokerConnection node_id=0 host=irlin328206:9092 <connected> [IPv6 ('fe80::9a90:96ff:fead:e31d', 9092, 0, 2)]> Request 5: FetchRequest_v4(replica_id=-1, max_wait_time=500, min_bytes=1, max_bytes=52428800, isolation_level=0, topics=[(topic='eolienne_jour_1', partitions=[(partition=0, offset=7270, max_bytes=1048576)])])\n",
      "Closing the KafkaConsumer.\n",
      "<BrokerConnection node_id=0 host=irlin328206:9092 <connected> [IPv6 ('fe80::9a90:96ff:fead:e31d', 9092, 0, 2)]>: Closing connection. \n",
      "Fetch to node 0 failed: Cancelled: <BrokerConnection node_id=0 host=irlin328206:9092 <connected> [IPv6 ('fe80::9a90:96ff:fead:e31d', 9092, 0, 2)]>\n",
      "The KafkaConsumer has closed.\n",
      "Reporting span 82c5f8c8c667ff79:54da1ff42b3f31b:e8b50acba0ece9a8:1 influxdb_test_insert_eolienne_1_jour.collect_data\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "7269\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n",
      "Reporting span 82c5f8c8c667ff79:a6a37ba7f2b67fd9:e8b50acba0ece9a8:1 influxdb_test_insert_eolienne_1_jour.insert_line\n",
      "Reporting span 82c5f8c8c667ff79:e8b50acba0ece9a8:0:1 influxdb_test_insert_eolienne_1_jour.test_line_insertion\n"
     ]
    },
    {
     "ename": "KeyboardInterrupt",
     "evalue": "",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-75-7d319aac08c3>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m    113\u001b[0m     \u001b[0mtracer\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0minit_tracer\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'influxdb_test_insert_eolienne_1_jour'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    114\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 115\u001b[0;31m     \u001b[0mtest_insert_line\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mclient\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mpolicy_name\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[0;32m<ipython-input-75-7d319aac08c3>\u001b[0m in \u001b[0;36mtest_insert_line\u001b[0;34m(client, policy)\u001b[0m\n\u001b[1;32m     96\u001b[0m         \u001b[0;32mwith\u001b[0m \u001b[0mspan_in_context\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mspan\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     97\u001b[0m             \u001b[0mdata\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mconsumer_single_topic\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 98\u001b[0;31m             \u001b[0minsert_line\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mclient\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mpolicy\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     99\u001b[0m             \u001b[0;31m#result=insert_line(client, policy, data)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    100\u001b[0m             \u001b[0;31m#return result\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m<ipython-input-75-7d319aac08c3>\u001b[0m in \u001b[0;36minsert_line\u001b[0;34m(client, policy, list_data)\u001b[0m\n\u001b[1;32m     86\u001b[0m             \u001b[0;32mfor\u001b[0m \u001b[0mdata\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mlist_data\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     87\u001b[0m                     \u001b[0;31m#print(data)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 88\u001b[0;31m                 \u001b[0mclient\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mwrite_points\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mretention_policy\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mpolicy\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mprotocol\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34mu'json'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     89\u001b[0m                 \u001b[0;31m#return \"sucess\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     90\u001b[0m             \u001b[0;31m#except :\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/local/anaconda3/lib/python3.7/site-packages/influxdb/client.py\u001b[0m in \u001b[0;36mwrite_points\u001b[0;34m(self, points, time_precision, database, retention_policy, tags, batch_size, protocol, consistency)\u001b[0m\n\u001b[1;32m    528\u001b[0m                                   \u001b[0mretention_policy\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mretention_policy\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    529\u001b[0m                                   \u001b[0mtags\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtags\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mprotocol\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mprotocol\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 530\u001b[0;31m                                   consistency=consistency)\n\u001b[0m\u001b[1;32m    531\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    532\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mping\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/local/anaconda3/lib/python3.7/site-packages/influxdb/client.py\u001b[0m in \u001b[0;36m_write_points\u001b[0;34m(self, points, time_precision, database, retention_policy, tags, protocol, consistency)\u001b[0m\n\u001b[1;32m    596\u001b[0m                 \u001b[0mparams\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mparams\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    597\u001b[0m                 \u001b[0mexpected_response_code\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m204\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 598\u001b[0;31m                 \u001b[0mprotocol\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mprotocol\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    599\u001b[0m             )\n\u001b[1;32m    600\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/local/anaconda3/lib/python3.7/site-packages/influxdb/client.py\u001b[0m in \u001b[0;36mwrite\u001b[0;34m(self, data, params, expected_response_code, protocol)\u001b[0m\n\u001b[1;32m    341\u001b[0m             \u001b[0mdata\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    342\u001b[0m             \u001b[0mexpected_response_code\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mexpected_response_code\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 343\u001b[0;31m             \u001b[0mheaders\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mheaders\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    344\u001b[0m         )\n\u001b[1;32m    345\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0;32mTrue\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/local/anaconda3/lib/python3.7/site-packages/influxdb/client.py\u001b[0m in \u001b[0;36mrequest\u001b[0;34m(self, url, method, params, data, expected_response_code, headers)\u001b[0m\n\u001b[1;32m    281\u001b[0m                     \u001b[0mproxies\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_proxies\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    282\u001b[0m                     \u001b[0mverify\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_verify_ssl\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 283\u001b[0;31m                     \u001b[0mtimeout\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_timeout\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    284\u001b[0m                 )\n\u001b[1;32m    285\u001b[0m                 \u001b[0;32mbreak\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/local/anaconda3/lib/python3.7/site-packages/requests/sessions.py\u001b[0m in \u001b[0;36mrequest\u001b[0;34m(self, method, url, params, data, headers, cookies, files, auth, timeout, allow_redirects, proxies, hooks, stream, verify, cert, json)\u001b[0m\n\u001b[1;32m    522\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    523\u001b[0m         settings = self.merge_environment_settings(\n\u001b[0;32m--> 524\u001b[0;31m             \u001b[0mprep\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0murl\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mproxies\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mstream\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mverify\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcert\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    525\u001b[0m         )\n\u001b[1;32m    526\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/local/anaconda3/lib/python3.7/site-packages/requests/sessions.py\u001b[0m in \u001b[0;36mmerge_environment_settings\u001b[0;34m(self, url, proxies, stream, verify, cert)\u001b[0m\n\u001b[1;32m    698\u001b[0m             \u001b[0;31m# Set environment's proxies.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    699\u001b[0m             \u001b[0mno_proxy\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mproxies\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'no_proxy'\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mproxies\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m \u001b[0;32melse\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 700\u001b[0;31m             \u001b[0menv_proxies\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mget_environ_proxies\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0murl\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mno_proxy\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mno_proxy\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    701\u001b[0m             \u001b[0;32mfor\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mk\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mv\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32min\u001b[0m \u001b[0menv_proxies\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mitems\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    702\u001b[0m                 \u001b[0mproxies\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msetdefault\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mk\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mv\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/local/anaconda3/lib/python3.7/site-packages/requests/utils.py\u001b[0m in \u001b[0;36mget_environ_proxies\u001b[0;34m(url, no_proxy)\u001b[0m\n\u001b[1;32m    762\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0;34m{\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    763\u001b[0m     \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 764\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mgetproxies\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    765\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    766\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/local/anaconda3/lib/python3.7/urllib/request.py\u001b[0m in \u001b[0;36mgetproxies_environment\u001b[0;34m()\u001b[0m\n\u001b[1;32m   2476\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0;34m'REQUEST_METHOD'\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0menviron\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2477\u001b[0m         \u001b[0mproxies\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpop\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'http'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2478\u001b[0;31m     \u001b[0;32mfor\u001b[0m \u001b[0mname\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mvalue\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0menviron\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mitems\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2479\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mname\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0;36m6\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;34m'_proxy'\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2480\u001b[0m             \u001b[0mname\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mname\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlower\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/local/anaconda3/lib/python3.7/_collections_abc.py\u001b[0m in \u001b[0;36m__iter__\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    742\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m__iter__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    743\u001b[0m         \u001b[0;32mfor\u001b[0m \u001b[0mkey\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_mapping\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 744\u001b[0;31m             \u001b[0;32myield\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_mapping\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    745\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    746\u001b[0m \u001b[0mItemsView\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mregister\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdict_items\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/local/anaconda3/lib/python3.7/os.py\u001b[0m in \u001b[0;36m__getitem__\u001b[0;34m(self, key)\u001b[0m\n\u001b[1;32m    673\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m__getitem__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mkey\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    674\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 675\u001b[0;31m             \u001b[0mvalue\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_data\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mencodekey\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    676\u001b[0m         \u001b[0;32mexcept\u001b[0m \u001b[0mKeyError\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    677\u001b[0m             \u001b[0;31m# raise KeyError with the original key value\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m: "
     ]
    }
   ],
   "source": [
    "from influxdb import InfluxDBClient\n",
    "from kafka import KafkaConsumer,TopicPartition\n",
    "import json\n",
    "import time\n",
    "import os\n",
    "import pandas as pd\n",
    "\n",
    "import time\n",
    "import logging\n",
    "from jaeger_client import Config\n",
    "from opentracing_instrumentation.request_context import get_current_span, span_in_context\n",
    "\n",
    "def influxdb_connect(domain, port, database_name):\n",
    "    print (\"Trying to connect to InfluxDB server without proxy:\", domain, \"on port:\", port)\n",
    "    proxies = { \"http\": None, \"https\": None}\n",
    "    try:\n",
    "        client = InfluxDBClient(host=domain, \n",
    "                                port=port, \n",
    "                                database=database_name,\n",
    "                                proxies=proxies)\n",
    "        print(\"connection sucess!\")\n",
    "        return client\n",
    "    except:\n",
    "        print(\"connection error!\")\n",
    "        return \n",
    "\n",
    "def init_tracer(service):\n",
    "    logging.getLogger('').handlers = []\n",
    "    logging.basicConfig(format='%(message)s', level=logging.DEBUG)    \n",
    "    config = Config(\n",
    "        config={\n",
    "            'sampler': {\n",
    "                'type': 'const',\n",
    "                'param': 1,\n",
    "            },\n",
    "            'logging': True,\n",
    "        },\n",
    "        service_name=service,\n",
    "    )\n",
    "    if config._initialized == False :\n",
    "        return config.initialize_tracer()\n",
    "    else :\n",
    "        print(\"error : create now tracer...\")\n",
    "        return config.new_tracer()    \n",
    "    \n",
    "def consumer_single_topic():\n",
    "    consumer = KafkaConsumer(bootstrap_servers='localhost:9092')\n",
    "    topic=\"eolienne_jour_1\"\n",
    "    tp = TopicPartition(topic,0)\n",
    "    consumer.assign([tp])\n",
    "    consumer.seek_to_end(tp)\n",
    "    lastOffset = consumer.position(tp)\n",
    "    print(lastOffset)\n",
    "    consumer.seek_to_beginning(tp) \n",
    "    #end\n",
    "    list_data=[]\n",
    "    with tracer.start_span('collect_data',child_of=get_current_span()) as span:\n",
    "        span.set_tag('kafka','collect_data_jour_1')\n",
    "        with span_in_context(span):\n",
    "            for message in consumer:\n",
    "                msg = message.value.decode()\n",
    "                influxdata=[{\n",
    "                    'measurement':\"smartGrid\",\n",
    "                    'tags':{\n",
    "                        'tag_1':\"eolienne\"\n",
    "                    },\n",
    "                    'time':msg.split(\";\")[0].split(\":\",1)[1],\n",
    "                    'fields': {\n",
    "                        'count': msg.split(\":\",1)[0],\n",
    "                        'message': msg.split(\";\",2)[2]\n",
    "                    }\n",
    "                }]\n",
    "                list_data.append(influxdata)\n",
    "                if message.offset == lastOffset - 1:\n",
    "                    print(message.offset)\n",
    "                    break\n",
    "            consumer.close()\n",
    "            return list_data\n",
    "        \n",
    "def insert_line(client, policy, list_data):\n",
    "    with tracer.start_span('insert_line',child_of=get_current_span()) as span:\n",
    "        span.set_tag('influxdb','operation:insert_line')\n",
    "        with span_in_context(span):\n",
    "            #try :\n",
    "            #print(list_data)\n",
    "            for data in list_data:\n",
    "                    #print(data)\n",
    "                client.write_points(data,retention_policy=policy,protocol=u'json')\n",
    "                #return \"sucess\"\n",
    "            #except : \n",
    "                #return \"error\"\n",
    "            \n",
    "def test_insert_line(client, policy):\n",
    "    with tracer.start_span('test_line_insertion') as span:\n",
    "        span.set_tag('influxdb','insertion_line')\n",
    "        with span_in_context(span):\n",
    "            data=consumer_single_topic()\n",
    "            insert_line(client, policy, data)\n",
    "            #result=insert_line(client, policy, data)\n",
    "            #return result\n",
    "\n",
    "    \n",
    "if __name__==\"__main__\":\n",
    "    database = \"test\"\n",
    "    policy_name = \"test_policy\"\n",
    "    client = influxdb_connect(\"localhost\", 9086,database)\n",
    "    client.create_retention_policy(name=policy_name, \n",
    "                                   duration=\"INF\", \n",
    "                                   database=\"test\",\n",
    "                                   replication=\"1\", \n",
    "                                   default=False,\n",
    "                                   shard_duration=\"1h50m\")\n",
    "    tracer = init_tracer('influxdb_test_insert_eolienne_1_jour')\n",
    "    \n",
    "    test_insert_line(client, policy_name)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "http://localhost:9086 \"GET /query?q=SHOW+DATABASES&db=test HTTP/1.1\" 200 None\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[{'name': '_internal'}, {'name': 'test'}]"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "client.get_list_database()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "metadata": {},
   "outputs": [],
   "source": [
    "test1=[{'measurement': 'smartGrid', \n",
    "     'tags': {\n",
    "         'tag_1': 'eolienne'\n",
    "     }, \n",
    "     'time': '2020-03-05T12:01:01.135558504Z', \n",
    "     'fields': {\n",
    "         'count': '3', \n",
    "         'message': '43.41266167;-0.641605;91.7;34.2;1.015;14.6;87.2;317.7;2.2;320.9;2;999;0;0;0;0;0;0;0;0;0;0;0;0;0'\n",
    "     }}]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [],
   "source": [
    "test=[\n",
    "    {'measurement': 'smartGrid', \n",
    "     'tags': {\n",
    "         'tag_1': 'eolienne'\n",
    "     }, \n",
    "     'time': '2020-03-05T12:01:01.135558504Z', \n",
    "     'fields': {\n",
    "         'count': '3', \n",
    "         'message': '43.41266167;-0.641605;91.7;34.2;1.015;14.6;87.2;317.7;2.2;320.9;2;999;0;0;0;0;0;0;0;0;0;0;0;0;0'\n",
    "     }\n",
    "},\n",
    "     {'measurement': 'smartGrid', \n",
    "     'tags': {\n",
    "         'tag_1': 'eolienne'\n",
    "     }, \n",
    "     'time': '2020-03-05T12:01:11.135558504Z', \n",
    "     'fields': {\n",
    "         'count': '3', \n",
    "         'message': '43.41266167;-0.641605;91.7;34.2;1.015;14.6;87.2;317.7;2.2;320.9;2;999;0;0;0;0;0;0;0;0;0;0;0;0;0'\n",
    "     }\n",
    "}]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 73,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "client.write_points(test1,retention_policy=\"test_policy\",protocol=u'json')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "http://localhost:9086 \"POST /write?db=test&rp=test_policy HTTP/1.1\" 204 0\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "client.write_points(test1,retention_policy=\"test_policy\",protocol=u'json')"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
